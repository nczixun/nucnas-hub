{{ define "main" }}
<div style="padding: 60px 0; max-width: 1200px; margin: 0 auto; min-height: 80vh;">

    <!-- 1. 顶部标题 -->
    <div style="text-align: center; margin-bottom: 50px;">
        <h1 style="font-size: 48px; font-weight: 700; letter-spacing: -0.01em; margin-bottom: 10px;">主机评测库</h1>
        <p style="color: #86868B; font-size: 20px;">全网主流机型参数与评测索引</p>
    </div>

    <!-- 2. 原生 JS 筛选按钮组 -->
    <div id="filter-container" style="display: flex; justify-content: center; gap: 12px; margin-bottom: 60px; flex-wrap: wrap;">
        <!-- 样式直接写在这里，不依赖外部 CSS -->
        <style>
            .filter-btn {
                padding: 10px 24px; border-radius: 999px; font-size: 14px; font-weight: 600; cursor: pointer;
                border: 1px solid rgba(0,0,0,0.05); background: #F5F5F7; color: #1D1D1F; transition: all 0.2s;
            }
            .filter-btn:hover { background: #E8E8ED; }
            
            /* 激活状态 */
            .filter-btn.active { 
                background: #1D1D1F; color: #FFFFFF; box-shadow: 0 4px 12px rgba(0,0,0,0.15); 
            }

            /* 卡片动画 */
            .product-card {
                transition: opacity 0.3s ease, transform 0.3s ease;
            }
            .product-card.hidden {
                display: none !important; /* 强制隐藏 */
            }
            .product-card.fade-in {
                animation: fadeIn 0.4s forwards;
            }
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
        </style>

        <!-- data-filter 属性用于存储筛选类别 -->
        <button class="filter-btn active" onclick="filterSelection('all', this)">全部</button>
        <button class="filter-btn" onclick="filterSelection('intel', this)">Intel 阵营</button>
        <button class="filter-btn" onclick="filterSelection('amd', this)">AMD 阵营</button>
        <button class="filter-btn" onclick="filterSelection('apple', this)">Apple Mac</button>
        <button class="filter-btn" onclick="filterSelection('nas', this)">成品 NAS</button>
    </div>

    <!-- 3. 产品网格 -->
    <div id="product-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px;">
        
        {{ range .Pages }}
        <!-- 获取 platform 字段，默认为 other -->
        {{ $platform := .Params.platform | default "other" }}
        
        <!-- 关键：把 platform 写入 data-category 属性，供 JS 读取 -->
        <a href="{{ .RelPermalink }}" 
           class="glass-card product-card"
           data-category="{{ $platform }}"
           style="text-decoration: none; color: inherit; padding: 30px; display: block; height: 100%;">
            
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
                <span style="font-size: 12px; font-weight: 700; color: #86868B; text-transform: uppercase; letter-spacing: 0.5px;">
                    {{ .Params.brand }}
                </span>
                
                <!-- 阵营颜色标记 (仅作视觉装饰) -->
                {{ if eq $platform "apple" }}<span style="width:8px; height:8px; background:#86868B; border-radius:50%;" title="Apple"></span>{{ end }}
                {{ if eq $platform "amd" }}<span style="width:8px; height:8px; background:#EF4444; border-radius:50%;" title="AMD"></span>{{ end }}
                {{ if eq $platform "intel" }}<span style="width:8px; height:8px; background:#3B82F6; border-radius:50%;" title="Intel"></span>{{ end }}
                {{ if eq $platform "nas" }}<span style="width:8px; height:8px; background:#10B981; border-radius:50%;" title="NAS"></span>{{ end }}
            </div>

            <h2 style="font-size: 20px; font-weight: 700; margin: 0 0 10px 0; line-height: 1.3;">
                {{ .Params.model }}
            </h2>
            
            <p style="font-size: 14px; color: #86868B; margin-bottom: 25px;">
                {{ .Params.cpu }}
            </p>

            <div style="font-size: 13px; color: #0071E3; font-weight: 600; display: flex; align-items: center; gap: 4px;">
                查看详细 &rarr;
            </div>
        </a>
        {{ end }}

    </div>
    
    <!-- 空状态提示 (默认隐藏) -->
    <div id="no-result" style="text-align: center; color: #86868B; padding: 50px; display: none;">
        该分类下暂无内容
    </div>

</div>

<!-- 4. 纯原生 JavaScript 逻辑 (直接写在页面里，绝对稳定) -->
<script>
    function filterSelection(category, btn) {
        var cards, i;
        cards = document.getElementsByClassName("product-card");
        
        // 1. 切换按钮激活状态
        var btns = document.getElementsByClassName("filter-btn");
        for (i = 0; i < btns.length; i++) {
            btns[i].classList.remove("active");
        }
        btn.classList.add("active");

        // 2. 筛选卡片
        var visibleCount = 0;
        for (i = 0; i < cards.length; i++) {
            var dataCat = cards[i].getAttribute("data-category");
            
            // 移除动画类，方便重新触发
            cards[i].classList.remove("fade-in");

            if (category == "all" || category == "") {
                cards[i].classList.remove("hidden");
                cards[i].classList.add("fade-in"); // 添加淡入动画
                visibleCount++;
            } else {
                if (dataCat === category) {
                    cards[i].classList.remove("hidden");
                    cards[i].classList.add("fade-in");
                    visibleCount++;
                } else {
                    cards[i].classList.add("hidden");
                }
            }
        }

        // 3. 处理空状态
        var noResult = document.getElementById("no-result");
        if (visibleCount === 0) {
            noResult.style.display = "block";
        } else {
            noResult.style.display = "none";
        }
    }
</script>
{{ end }}